
\begin{tikzpicture}[scale=0.5]

\draw  (-1.25,2) rectangle (+1.25,-2);
\draw  (4.5,2) rectangle (7,0);
\node at (0,0) {\Large \textbf{Alice}};
\node at (5.75,1) {\Large \textbf{Eve}};
\node at (11.5,0) {\Large \textbf{Bob}};
\node (v2) at (-0.05,2) {};
\node (v4) at (0.05,2) {};
\node (v1) at (1,3.5) {\Large $a_1$};
\node (v3) at (-1,3.5) {\Large $a_0$};
\draw[-triangle 90, line width=1pt]  (v1) edge (v4);
\draw[-triangle 90, line width=1pt]  (v3) edge (v2);
\node (v5) at (1.25,1) {};
\node (v6) at (4.5,1) {};
\draw[-triangle 90, line width=1pt]  (v5) edge node[sloped,above] {\large{$\rho_{a_0,a_1}$}} (v6);
\node (v8) at (5.75,2) {};
\node (v7) at (5.75,3.5) {\Large $e$};
\draw[-triangle 90, line width=1pt]  (v7) edge (v8);
\node (v9) at (5.75,-4.5) {};
\node (v10) at (5.75,-6) {\Large $E=a_e$};
\draw[-triangle 90, line width=1pt]  (v9) edge (v10);
\draw  (10.25,2) rectangle (12.75,-2);

\node (v12) at (11.5,2) {};
\node (v11) at (11.5,3.5) {\Large $b$};
\node (v13) at (11.5,-2) {};
\node (v14) at (11.5,-3.5) {\Large $B=a_b$};
\draw[-triangle 90, line width=1pt]  (v11) edge (v12);
\draw[-triangle 90, line width=1pt]  (v13) edge (v14);
\node (v15) at (7,1) {};
\node (v16) at (10.25,1) {};
\draw[-triangle 90, line width=1pt]  (v15) edge node[sloped,above] {\large{$\rho_{a_0,a_1,e,E}$}} (v16);
\node (v17) at (10.25,-1) {};
\node (v18) at (1.25,-1) {};
\draw[-triangle 90, line width=1pt] (v17) edge node[sloped,above] {\small{classical comm.}} (v18);
\draw  (4.5,-2.5) rectangle (7,-4.5);
\node (v19) at (5.75,-1) {};
\node (v20) at (5.75,-2.5) {};
\draw[-triangle 90, line width=1pt, line width=1pt]  (v19) edge (v20);
\node at (5.75,-3.5) {\Large{\textbf{Eve}}};


\end{tikzpicture}


